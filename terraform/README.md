# Deploy lambda - terraform modules

There are a few ways to deploy lambda using terraform. We can use basic AWS provider resource modules and build the code
ourselves using CICD pipeline. I really like a quick approach using one of the officially approved modules from
Terraform Registry.

Module description - https://registry.terraform.io/modules/terraform-aws-modules/lambda/aws/latest

Module was created using multiple aws resources to simplify lambda build and deployment process. Building process
supports both local and in-Docker building for compatibility. Lambda deployment in provided example looks simple, but
all magic is done underneath the hood. By default, code in given source path is zipped and placed in `builds` folder.
Then lambda is created using direct Zip upload. If you want to use S3 as artifact storage, this is possible with this
module - example code are directly in documentation. Thanks to hashing function - code is replaced in lambda only when
it changes. For more details go to module's github repo or review plan generated by `terraform plan` command.

Layers are important mechanism that allows adding resources like files or libraries to multiple lambdas and manage them
from single point. In example few files were put into it and can be accessed by lambda. There is a trade off when using
layers, local development is more challenging to set up and execute then.

In production environment always use backends! For simulation this part was excluded intentionally.

```bash
#init terraform modules
terraform init

#deploy
terraform apply

#destroy
terraform destroy
```

PROS:

- support for simple to complex scenarios including layers deployment
- declarative approach where you define a state you want to archive
- supports waiting for resources being created
- allows creation of resources
- allows multi-cloud approach and can create other resources (i.e. Kubernetes resources)
- supports both artifact types (Zip/Docker Image)
- support for multiple environments in form of workspaces

CONS:

- does not support lambda execution/debugging
- module is still fresh and has some unresolved issues
- supports Python 3.6 or higher (for Python 2.7 build code and provide as artifact)


